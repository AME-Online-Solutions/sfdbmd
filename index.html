<!DOCTYPE html>
<html>
<head>
<style>
  body {
    margin:5px;
    padding:0;
    font-size:14px;
    /*background:url(https://login.ameonlinesolutions.com/images/AMELogo-Watermark.jpg);*/
    background:url(https://login.ameonlinesolutions.com/images/AMELogo-Watermark4.jpg);
    background-repeat:repeat;
    background-color:#FEF5E7;        
  }
	.button {
		background-color: #008CBA; /* Blue */
		border: none;
		color: white;
		padding: 5px 12px;
		text-align: center;
		text-decoration: none;
		display: inline-block;
		font-size: 16px;
		margin: 4px 2px;
		cursor: pointer;
		width:200px;
	}
	.button1 {background-color: #4CAF50;} /* Green */
	.button3 {background-color: #f44336;} /* Red */ 

	.BackgroundPattern1{
  	color:white;
  	background-image: linear-gradient(45deg, transparent 20%, black 25%, transparent 25%), 
                    linear-gradient(-45deg, transparent 20%, black 25%, transparent 25%), 
                    linear-gradient(-45deg, transparent 75%, black 80%, transparent 0),
                    radial-gradient(gray 2px, transparent 0);
  	background-size: 30px 30px, 30px 30px;
  	background-color:#b47800;
  	background-size:12px 12px;
	}
	// **************************  spin image   *************************
	.spinimage {
	  -webkit-animation:spin 4s linear infinite;
	  -moz-animation:spin 4s linear infinite;
	  animation:spin 4s linear infinite;
	}
	@-moz-keyframes spin { 100% { -moz-transform: rotate(360deg); } }
	@-webkit-keyframes spin { 100% { -webkit-transform: rotate(360deg); } }
	@keyframes spin { 100% { -webkit-transform: rotate(360deg); transform:rotate(360deg); } }
	.rotateimage{
	  display:block;
	  -webkit-animation: rotation 7s infinite linear;
	}
	.spinme{
	  display:block;
	  -webkit-animation: spin 7s infinite linear;
	}

	@-webkit-keyframes rotation {
	  from {
	    -webkit-transform: rotateY(90deg);
	    -moz-transform: rotateY(90deg);
	    -o-transform: rotateY(90deg);
	    transform: rotateY(90deg);	
	  }
	  to {
	    -webkit-transform: rotateY(-90deg);
	    -moz-transform: rotateY(-90deg);
	    -o-transform: rotateY(-90deg);
	    transform: rotateY(-90deg);	
	  }
	}

</style>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
  $("#_cw_MainDiv button").click(function(){
    if(this.name=="SampleProblems"){SampleProblems(this.value);}
    if(this.id.substring(0,4)=="_cw_"){
      switch(this.id){
        case "_cw_addBeam":
          sidh("_cw_LoadFigure",gidh("_cw_addBeamHidden"));
          $("#_cw_LoadFigure button").click(function(){
            sidh("_cw_MaxX",gidv("_cw_beamLength"));
            let appendRow=["Beam",0,gidv("_cw_beamLength"),"","",""];
          });
          break;
        case "_cw_addSupport":
          sidh("_cw_LoadFigure",gidh("_cw_addSupportHidden"));
          $("#_cw_LoadFigure button").click(function(){
            //alert(this.id);
            //alert($("#_cw_LoadFigure [name='support_choice']").filter(function() { return this.checked;})[0].value);
            //alert(gidv("_cw_SupportPosition"));
             let appendRow=[$("#_cw_LoadFigure [name='support_choice']").filter(function() { return this.checked;})[0].value,gidv("_cw_SupportPosition"),"","","",""];
            show_LoadTable(appendRow);refreshSFDBMD();
         });
          break;
        case "_cw_addPointLoad":
          sidh("_cw_LoadFigure",gidh("_cw_addPointLoadHidden"));
          $("#_cw_LoadFigure button").click(function(){
            //alert(this.igidv("_cw_SupportPosition")d);
            if(Number(gidv("_cw_LoadMagnitude"))>Number(gidh("_cw_MaxY"))){sidh("_cw_MaxY",gidv("_cw_LoadMagnitude"));}
            if(Number(gidv("_cw_LoadMagnitude"))<Number(gidh("_cw_MinY"))){sidh("_cw_MinY",gidv("_cw_LoadMagnitude"));}
            
            let appendRow=["Point Load", gidv("_cw_LoadLocation"),"", gidv("_cw_LoadMagnitude"), "",gidv("_cw_LoadDirection")];
            show_LoadTable(appendRow);refreshSFDBMD();
          });
          break;
        case "_cw_addMoment":
          sidh("_cw_LoadFigure",gidh("_cw_addMomentHidden"));
          $("#_cw_LoadFigure button").click(function(){
            //alert(this.id);
            let appendRow=["Moment", gidv("_cw_MomentLocation"),"", gidv("_cw_MomentMagnitude"), "",gidv("_cw_MomentDirection")];
            show_LoadTable(appendRow);refreshSFDBMD();
          });
          break;
        case "_cw_addDistributedLoad":
          sidh("_cw_LoadFigure",gidh("_cw_addDistributedLoadHidden"));
          $("#_cw_LoadFigure button").click(function(){
            //alert(this.id);
            if(Number(gidv("_cw_StartMagnitude"))>Number(gidh("_cw_MaxY"))){sidh("_cw_MaxY",gidv("_cw_StartMagnitude"));}
            if(Number(gidv("_cw_EndMagnitude"))>Number(gidh("_cw_MaxY"))){sidh("_cw_MaxY",gidv("_cw_EndMagnitude"));}
            if(Number(gidv("_cw_StartMagnitude"))<Number(gidh("_cw_MinY"))){sidh("_cw_MinY",gidv("_cw_StartMagnitude"));}
            if(Number(gidv("_cw_EndMagnitude"))<Number(gidh("_cw_MinY"))){sidh("_cw_MinY",gidv("_cw_EndMagnitude"));}
            let appendRow=["Distributed Load", gidv("_cw_StartPosition"), gidv("_cw_EndPosition"), gidv("_cw_StartMagnitude"), gidv("_cw_EndMagnitude"),""];
            show_LoadTable(appendRow);refreshSFDBMD();
          });
          break;
        case "_cw_RemoveIt":
          //alert(gidv("_cw_RemoveRow"));
          Data=JSON.parse(gidh("_cw_LoadData"));
          for(let i=2;i<Data.length;i++){if(Data[i].join("_")==gidv("_cw_RemoveRow")){Data.splice(i,1);sidh("_cw_LoadData",JSON.stringify(Data));refreshSFDBMD();}}
          //sidh("_cw_LoadFigure",gidh("_cw_addDistributedLoadHidden"));
          break;
        default: alert(this.id);break;
      }
    }
  });
});



function Transpose_(array){
  if(array==null || array==[] || array.length==0 ){return array;}
  return array[0].map(function(col, i) { return array.map(function(row) { return row[i] }) });
}
async function gsrfn(query)
{
	var p="https://script.google.com/macros/s/AKfycbyH2V4BDffuvygU_jyhmyJvFIGjj6LlNXLVHWMyubsw7960mI06/exec?"+query;
	var obj;
	await fetch(p).then(res=>res.text().then(res => {
		//document.getElementById(target_id).innerHTML=res;
		obj = JSON.parse(res);
	}));
	return obj;
}

Array.prototype.col = function(cNo) {return this.map(function(value,index) {return value[cNo];});}
function gid(id){return document.getElementById(id);}
function gidv(id){return document.getElementById(id).value;}
function sidv(id,val){return document.getElementById(id).value=val;}
function gidh(id){if(gid(id)==null){console.log(id);};return document.getElementById(id).innerHTML;}
function sidh(id,val){if(gid(id)==null){console.log(id);};return document.getElementById(id).innerHTML=val;}

function SimpleD2T(Data,tableid){
  var table="";
  table+= "<table id='"+tableid+"' border=1 style='border-collapse:collapse;' > ";
  for(var i=0;i<Data.length;i++){
    if(i==0){
      table+="<thead><tr><th>"+Data[i].join("</th><th>")+"</th></tr></thead><tbody>";
    }else{
      table+="<tr><td ><div align=center>"+Data[i].join("</div></td><td><div align=center>")+"</td></tr>";
    }
  }
  table+="</tbody></table>";
  return table;
}
function sortByColumn_(a, colIndex,headerrow){
  if(headerrow==1){ var R0=[]; R0[0]=a[0]; a.splice(0,1); a=sortByColumn0_(a, colIndex); a.splice(0,0,R0[0]);}else{a=sortByColumn0_(a, colIndex);}
  return a;
}
function sortByColumn0_(a, colIndex){
  a.sort(sortFunction);
  function sortFunction(a, b) { if (a[colIndex] === b[colIndex]) { return 0; } else { return (a[colIndex] < b[colIndex]) ? -1 : 1; } }
  return a;
}


function draw_text(ctx,p,txt,fnt){
  if(fnt==null || fnt==""){ctx.font = "12px Arial";}else{ctx.font=fnt;}
  ctx.fillStyle = "black";
  ctx.fillText(txt, p.x, p.y);
}
function show_dimensions(ctx,p0,Data){
  let Y=350;
  let ctxlw=ctx.lineWidth;
  ctx.lineWidth=0.5;
  for(let i=2;i<Data.length;i++){
    if(Data[i][0].toString().trim()=="Beam"){
      let X=Number(Data[i][2]); let X1=p0.x+X*p0.scaleX; ctx.beginPath(); ctx.moveTo(p0.x, Y+2); ctx.lineTo(p0.x, Y+18); ctx.stroke(); ctx.beginPath(); ctx.moveTo(p0.x, Y+10); ctx.lineTo(X1+20, Y+10); ctx.stroke(); ctx.beginPath(); ctx.moveTo(X1+15, Y+5); ctx.lineTo(X1+20, Y+10); ctx.lineTo(X1+15, Y+15); ctx.stroke(); draw_text(ctx,{x:X1+30,y:Y+15},"x");
    }
    let X=Number(Data[i][1]);let X1=p0.x+X*p0.scaleX;ctx.beginPath(); ctx.moveTo(X1, Y+2); ctx.lineTo(X1, Y+18); ctx.stroke(); draw_text(ctx,{x:X1-10,y:Y+30},X);
    if(Data[i][2]!=""){
      let X=Number(Data[i][2]);let X1=p0.x+X*p0.scaleX;ctx.beginPath(); ctx.moveTo(X1, Y+2);ctx.lineTo(X1, Y+18);ctx.stroke(); draw_text(ctx,{x:X1-10,y:Y+30},X);
    }
  }
  ctx.lineWidth=ctxlw;
}

function draw_moment(ctx,p){
  let ctxlw=ctx.lineWidth; ctx.lineWidth=2; let R=30,theta1=Math.PI-Math.PI/6,theta2=2*Math.PI+Math.PI/2; ctx.beginPath(); ctx.arc(p.x, p.y, R, theta1,theta2); ctx.stroke(); ctx.beginPath(); ctx.arc(p.x, p.y, 5, 0,2*Math.PI); ctx.stroke(); let theta=theta1; if(p.dir!="CC"){p.dir="C";theta=theta2;}; let ep={x:p.x+R*Math.cos(theta),y:p.y+R*Math.sin(theta)};
  if(p.dir!="CC"){
    ctx.beginPath();ctx.moveTo( ep.x+7, ep.y-7);ctx.lineTo( ep.x, ep.y );ctx.lineTo( ep.x+10, ep.y+5);ctx.stroke();draw_text(ctx,{x:ep.x-10,y:ep.y-10},p.m);
  }else{
    ctx.beginPath();ctx.moveTo( ep.x+3, ep.y-7);ctx.lineTo( ep.x, ep.y );ctx.lineTo( ep.x-8, ep.y-5);ctx.stroke();draw_text(ctx,{x:ep.x+10,y:ep.y+10},p.m);
  }
  ctx.lineWidth=ctxlw;
}

function draw_support(ctx,p){
  //type - Hinged, Roller, Fixed-Left,Fixed-Right
  //p={x:550,y:150,type:"Fixed-Right"}
  let ctxlw=ctx.lineWidth
  switch(p.type){
    case "Hinged":
      ctx.lineWidth=2;ctx.beginPath();ctx.moveTo( p.x, p.y);ctx.lineTo( p.x-7, p.y+22);ctx.lineTo( p.x+7, p.y+22);ctx.lineTo( p.x, p.y);ctx.stroke(); 
      ctx.lineWidth=1;
      for(let x=p.x-10;x<=p.x+10;x=x+5){
        ctx.beginPath();ctx.moveTo(x, p.y+22); ctx.lineTo(x-4, p.y+22+4);ctx.stroke(); 
      }
      break; 
    case "Roller":
      ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo( p.x, p.y); ctx.lineTo( p.x-7, p.y+12); ctx.lineTo( p.x+7, p.y+12); ctx.lineTo( p.x, p.y); ctx.stroke(); ctx.beginPath(); ctx.arc(p.x-7,p.y+12+5, 5, 0, 2 * Math.PI); ctx.stroke(); ctx.beginPath(); ctx.arc(p.x+7,p.y+12+5, 5, 0, 2 * Math.PI); ctx.stroke(); ctx.lineWidth=1; 
      for(let x=p.x-10;x<=p.x+10;x=x+5){
        ctx.beginPath(); ctx.moveTo(x, p.y+12+10); ctx.lineTo(x-4, p.y+12+4+10); ctx.stroke(); 
      }
      break; 
    case "Fixed-Left":
      ctx.lineWidth=2;ctx.beginPath(); ctx.moveTo( p.x, p.y-20); ctx.lineTo( p.x, p.y+20); ctx.stroke(); 
      for(let y=p.y-20;y<=p.y+20;y=y+5){
        ctx.beginPath(); ctx.moveTo(p.x, y); 
        ctx.lineTo(p.x-4, y+4); ctx.stroke(); 
      }
      break;
    case "Fixed-Right":
      ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo( p.x, p.y-20); ctx.lineTo( p.x, p.y+20);ctx.stroke(); 
      for(let y=p.y-20;y<=p.y+20;y=y+5){
        ctx.beginPath(); ctx.moveTo(p.x, y); ctx.lineTo(p.x+4, y+4); ctx.stroke(); 
      }
      break;
  }
  ctx.lineWidth=ctxlw;
}

function draw_Arrow( ctx, p1,p2) {
  if(Math.abs(p2.x - p1.x)<=0.5 && Math.abs(p2.y - p1.y)<=0.5){return "";}
  let ctxlw=ctx.lineWidth; ctx.lineWidth=2; const dx = p2.x - p1.x; const dy = p2.y - p1.y; const headlen = 10;  const angle = Math.atan2( dy, dx ); ctx.beginPath(); ctx.moveTo( p1.x, p1.y ); ctx.lineTo( p2.x, p2.y ); ctx.stroke(); ctx.beginPath(); ctx.moveTo( p2.x - headlen * Math.cos( angle - Math.PI / 6 ), p2.y - headlen * Math.sin( angle - Math.PI / 6 ) ); ctx.lineTo( p2.x, p2.y ); ctx.lineTo( p2.x - headlen * Math.cos( angle + Math.PI / 6 ), p2.y - headlen * Math.sin( angle + Math.PI / 6 ) ); ctx.stroke(); ctx.lineWidth=ctxlw;
}
function draw_pointLoad(ctx, p) {
  if(p.theta==null){p.theta=90;}; let theta=Number(p.theta); p.theta=p.theta*Math.PI/180; let p1={x:p.x-p.l*Math.cos(p.theta),y:p.y-p.l*p.scaleY*Math.sin(p.theta)}; let p2={x:p.x,y:p.y}; let angletext=""; if(theta!=90){angletext="("+theta+"°)";}; draw_text(ctx,p1,p.l+angletext); return draw_Arrow( ctx, p1,p2);
}

function draw_DistributedLoad(ctx,p1,p2){  //distributed load
  let ctxlw=ctx.lineWidth; draw_text(ctx,{x:p1.x-10,y:p1.y-p1.l*p1.scaleY-10},p1.l);draw_text(ctx,{x:p2.x-10,y:p2.y-p2.l*p2.scaleY-10},p2.l);
  let xl=0;
  for(let x=p1.x;x<=p2.x-20;x=Number(x)+20){
  	let ht=Number(p1.l*p1.scaleY)+Number((p2.l*p2.scaleY-p1.l*p1.scaleY)*(x-p1.x)/(p2.x-p1.x));draw_Arrow(ctx, {x:x,y:p1.y-ht},{x:x,y:p1.y});xl=x;
  }
  draw_Arrow(ctx, {x:p2.x,y:p1.y-p2.l*p2.scaleY},{x:p2.x,y:p1.y}); ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo( p1.x, p1.y-p1.l*p1.scaleY ); ctx.lineTo( p2.x, p1.y-p2.l*p2.scaleY ); ctx.stroke(); ctx.lineWidth=ctxlw;
}

function draw_Beam(ctx,p0,rowContents){
  //console.log(JSON.stringify(rowContents));
  ctx.beginPath();ctx.lineWidth = 5;ctx.lineCap = "butt";ctx.moveTo(p0.x, p0.y);ctx.lineTo(p0.x+Number(rowContents[2])*p0.scaleX, p0.y);ctx.stroke();ctx.lineWidth=3;
}
function showLandmarks(ctxSFBM,x,y,scaleX,scaleY,X1){
  Yd=370;
  ctxSFBM.beginPath(); ctxSFBM.moveTo(x, Yd); ctxSFBM.lineTo(X1+20, Yd); ctxSFBM.stroke(); 
  ctxSFBM.beginPath(); ctxSFBM.moveTo(X1+15, Yd-5); ctxSFBM.lineTo(X1+20, Yd); ctxSFBM.lineTo(X1+15, Yd+5); ctxSFBM.stroke(); 
  let Landmarks=JSON.parse(gidh("_cw_Landmarks"));
  if(Landmarks!=null && Landmarks.length>0){
  	for(let i=0;i<Landmarks.length;i++){
  	  ctxSFBM.beginPath(); ctxSFBM.moveTo(Number(x)+Number(Landmarks[i])*scaleX, Yd-3); ctxSFBM.lineTo(Number(x)+Number(Landmarks[i])*scaleX, Yd+3); ctxSFBM.stroke(); 
  	  draw_text(ctxSFBM,{x:Number(x)+Number(Landmarks[i])*scaleX,y:Yd+20},Number(Landmarks[i]).toFixed(2));
  	  draw_text(ctxSFBM,{x:Number(x)+Number(Landmarks[i])*scaleX,y:Yd-10},String.fromCharCode(64+i));
  	}
  }
  
}
//function sfd_intercept(ctxSFBM,x,y,scaleX,scaleY,interceptX,Yd){
//	console.log(interceptX);
	//ctxSFBM.beginPath(); ctxSFBM.moveTo(Number(x)+Number(interceptX)*scaleX, Yd-3); ctxSFBM.lineTo(Number(x)+Number(interceptX)*scaleX, Yd+3); ctxSFBM.stroke(); 
//	draw_text(ctxSFBM,{x:Number(x)+Number(interceptX)*scaleX,y:Yd-15},interceptX.toFixed(3));
//}
function showGraphOnCanvas(GraphData,GraphId,CId,Landmarks){
  //console.log(GraphData);
  GraphData.shift();
  let MinX=100000,MaxX=0,MinY=100000,MaxY=0;
  for(let i=0;i<GraphData.length;i++){
  	GraphData[i][0]=Number(GraphData[i][0]);
  	GraphData[i][1]=Number(GraphData[i][1]);
  	if(MinX>GraphData[i][0]){MinX=GraphData[i][0];}
  	if(MaxX<GraphData[i][0]){MaxX=GraphData[i][0];}
  	if(MinY>GraphData[i][1]){MinY=GraphData[i][1];}
  	if(MaxY<GraphData[i][1]){MaxY=GraphData[i][1];}
  }
  //console.log("MinX = "+MinX+"  MaxX="+MaxX+"   MinY = "+MinY+"  MaxY="+MaxY);
  let scaleX=500/MaxX,scaleY=200/(MaxY-MinY),x=50,y=50+MaxY*scaleY;  //300-MinY200/(MaxY-MinY);
  let Yd=370;
  //console.log("scaleX = "+scaleX+"  scaleY="+scaleY+"   x = "+x+"  y="+y);
  sidh(GraphId,'<canvas id="'+CId+'" width="600" height="400" style="border:1px solid #d3d3d3;">Your browser does not support the HTML5 canvas tag.</canvas>');
  let c = document.getElementById(CId);let ctxSFBM = c.getContext("2d");
  ctxSFBM.fillStyle = "white";ctxSFBM.fillRect(0, 0, 600, 400);
  //ctxSFBM.globalAlpha = 0.2;
  let Y=y;
  let X=Number(MaxX); let X1=x+X*scaleX; 
  //ctxSFBM.beginPath(); ctxSFBM.moveTo(x, Y+2); ctxSFBM.lineTo(x, Y+18); ctxSFBM.stroke();   
  ctxSFBM.beginPath(); ctxSFBM.moveTo(x, Y); ctxSFBM.lineTo(X1+20, Y); ctxSFBM.stroke(); 
  ctxSFBM.beginPath(); ctxSFBM.moveTo(X1+15, Y-5); ctxSFBM.lineTo(X1+20, Y); ctxSFBM.lineTo(X1+15, Y+5); ctxSFBM.stroke(); 
  
  showLandmarks(ctxSFBM,x,y,scaleX,scaleY,X1)
   //X=Number(MaxX);X1=x+X*scaleX;ctxSFBM.beginPath(); ctxSFBM.moveTo(X1, Y+2); ctxSFBM.lineTo(X1, Y+18); ctxSFBM.stroke(); draw_text(ctxSFBM,{x:X1-10,y:Y+30},X);
   //plot
  ctxSFBM.beginPath(); ctxSFBM.moveTo(Number(x)+GraphData[0][0]*scaleX, Number(y)+GraphData[0][1]*scaleY);
  for(let i=0;i<GraphData.length;i++){
   	sidh("contraflexure","");
   	ctxSFBM.lineTo(Number(x)+GraphData[i][0]*scaleX, Number(y)-GraphData[i][1]*scaleY);
   	if(Math.abs(GraphData[i][1])>0.5){
   		let showval=false;
   		for(let i2=0;i2<Landmarks.length;i2++){
   		  //console.log(Landmarks[i2]-GraphData[i][0]);
   		  if(Landmarks[i2]-GraphData[i][0]==0){showval=true;}
   		  if(i<GraphData.length-1 && GraphData[i][0]-GraphData[i+1][0]==0 && Math.abs(GraphData[i][1]-GraphData[i+1][1])<1){showval=false;}
   		}
   		if(showval==true){
   			draw_text(ctxSFBM,{x:Number(x)+GraphData[i][0]*scaleX+3,y:Number(y)-GraphData[i][1]*scaleY-5},GraphData[i][1].toFixed(3));
   			ctxSFBM.arc(Number(x)+GraphData[i][0]*scaleX, Number(y)-GraphData[i][1]*scaleY, 2, 0, 2 * Math.PI);
   			ctxSFBM.moveTo(Number(x)+GraphData[i][0]*scaleX, Number(y)-GraphData[i][1]*scaleY);
   		}
   	}
  }
  ctxSFBM.stroke();
}


function show_FBD(){
  //console.log("sfbd");
  sidh("_cw_LoadFigure",'<canvas id="myCanvas" width="600" height="400" style="border:1px solid #d3d3d3;background:white;">Your browser does not support the HTML5 canvas tag.</canvas>');
  var c = document.getElementById("myCanvas");var ctx = c.getContext("2d");
  let Data=JSON.parse(gidh("_cw_LoadData"));
  let DataCol1=Data.map(function(value,index) {return value[0];});
  let index=DataCol1.indexOf("Beam");
  
  let MaxX=0,MaxY=0,MinY=100000;
  for(let i=2;i<Data.length;i++){
  	if(Data[i][0].indexOf("Support")==-1){
  		if(Number(Data[i][1])>MaxX){MaxX=Number(Data[i][1]);}
  		if(Number(Data[i][2])>MaxX){MaxX=Number(Data[i][2]);}
  		if(Number(Data[i][3])>MaxY){MaxY=Number(Data[i][3]);}
  		if(Number(Data[i][4])>MaxY){MaxY=Number(Data[i][4]);}
  		if(Number(Data[i][3])<MinY){MinY=Number(Data[i][3]);}
  		if(Number(Data[i][4])<MinY){MinY=Number(Data[i][4]);}
  	}
  }
  //console.log("MaxX = "+MaxX+"   MaxY ="+MaxY+"   MinY ="+MinY)
  sidh("_cw_MaxX",MaxX);sidh("_cw_MaxY",MaxY);sidh("_cw_MinY",MinY);
  if(Number(MinY)>0){MinY=0;}
  if(MaxY==MinY){MaxY=100;}
  let p0={scaleX:500/MaxX,scaleY:200/(MaxY-MinY),x:50,y:300-MinY*200/(MaxY-MinY)};
  sidh("tempvals", p0.scaleX+" "+p0.scaleY+" "+p0.x+" "+p0.y)
  //console.log("p0.scaleX = "+p0.scaleX+" p0.scaleY="+p0.scaleY+"    p0.x="+p0.x+"   p0.y="+p0.y)
  show_dimensions(ctx,p0,Data);
  for(let i=2;i<Data.length;i++){
  	if(Data[i][0]=="Beam"){draw_Beam(ctx,p0,Data[i]);};
  	if(Data[i][0].indexOf("Support")>-1){draw_support(ctx,{type:Data[i][0].split(" ")[0],x:p0.x+p0.scaleX*Data[i][1],y:p0.y})};
  	if(Data[i][0]=="Moment"){draw_moment(ctx,{x:p0.x+p0.scaleX*Data[i][1],y:p0.y,dir:Data[i][5],m:Data[i][3]});};
  	if(Data[i][0]=="Point Load"){draw_pointLoad(ctx, {x:p0.x+p0.scaleX*Data[i][1],y:p0.y,l:Data[i][3],theta:Data[i][5],scaleY:p0.scaleY})};
  	if(Data[i][0]=="Distributed Load"){draw_DistributedLoad(ctx, {x:p0.x+p0.scaleX*Data[i][1],y:p0.y,l:Data[i][3],scaleY:p0.scaleY}, {x:p0.x+p0.scaleX*Data[i][2],y:p0.y,l:Data[i][4],scaleY:p0.scaleY})};
  }
  
}

async function sfd_bmd_Table(){
  let Data=JSON.parse(gidh("_cw_LoadData"));
  //https://script.google.com/macros/s/AKfycbyH2V4BDffuvygU_jyhmyJvFIGjj6LlNXLVHWMyubsw7960mI06/exec?fn=getRequest&request=abcd
  //console.log(Data);
  var rObj = await gsrfn("fn=sfd_bmd_Table&Data="+JSON.stringify(Data)+"&MaxX="+gidh("_cw_MaxX")+"");
  //console.log(rObj);
  if(rObj.text2==""){return "";}
  
	sidh("_cw_LoadData",JSON.stringify(rObj.Data));
	sidh("_cw_Landmarks",JSON.stringify(rObj.Landmarks));
	show_LoadTable();
	sidh("sfd_bmd_solution",rObj.text2);
	
	GraphData=Transpose_([rObj.sbl2[0],rObj.sbl2[1]]);
	for(let i=GraphData.length-1;i>0;i--){if(GraphData[i][0]-GraphData[i-1][0]==0 && GraphData[i][1]-GraphData[i-1][1]==0){GraphData.splice(i,1);}}
	//console.log(GraphData);
	//GraphData.splice(1,0,[0,0]);
	//GraphData.push([GraphData[GraphData.length-1][0],0]);
	showGraphOnCanvas(GraphData,"_cw_showSFD2","showSFD3",rObj.Landmarks);

	GraphData=Transpose_([rObj.sbl2[0],rObj.sbl2[2]]);
	for(let i=GraphData.length-1;i>0;i--){if(GraphData[i][0]-GraphData[i-1][0]==0 && GraphData[i][1]-GraphData[i-1][1]==0){GraphData.splice(i,1);}}
	//GraphData.splice(1,0,[0,0]);
	//GraphData.push([GraphData[GraphData.length-1][0],0]);
	showGraphOnCanvas(GraphData,"_cw_showBMD2","showBMD3",rObj.Landmarks);
	
	//for(let i=1;i<GraphData.length;i++){GraphData[i][0]=Number(GraphData[i][0]);GraphData[i][1]=Number(GraphData[i][1]);}
  
}
function SampleProblems(ProbNo){
	
	switch(Number(ProbNo)){
		case 1:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","",-44.44444444444444,"",""],["Roller Support","9","",-55.55555555555556,"",""],["Point Load","5","","100","","90"]]');refreshSFDBMD();
			break;
		case 2:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","",-44.44444444444444,"",""],["Roller Support","9","",-55.55555555555556,"",""],["Point Load","5","","100","","60"]]');refreshSFDBMD();
			break;
		case 3:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","",-44.44444444444444,"",""],["Roller Support","9","",-55.55555555555556,"",""],["Distributed Load","2","6","10","10",""]]');refreshSFDBMD();
			break;
		case 4:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","","","",""],["Roller Support","9","","","",""],["Distributed Load","2","6","0","10",""]]');refreshSFDBMD();
			break;
		case 5:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","","","",""],["Roller Support","9","","","",""],["Distributed Load","2","6","10","20",""]]');refreshSFDBMD();
			break;
		case 6:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"10","","",""],["Hinged Support","0","",-80,"",""],["Roller Support","10","",-50,"",""],["Distributed Load","2","6","10","10",""],["Point Load","2","","50","","90"],["Point Load","6","","40","","90"]]');refreshSFDBMD();
			break;
		case 7:
			sidh("_cw_LoadData",'[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"10","","",""],["Distributed Load","0","5","0","20",""],["Distributed Load","5","10","20","0",""],["Hinged Support","0","","","",""],["Roller Support","10","","","",""]]');refreshSFDBMD();
			break;
		default: alert(ProbNo);break;
	}
}
function show_LoadTable(appendRow){
  let Data=[["Type", "Start/Point Position (m)", "End Position (m)", "Start/Point Magnitude (kN/m)", "End Magnitude (kN/m)","Direction"],["","","","","",""]];
  if(gidh("_cw_LoadData")!=""){Data=JSON.parse(gidh("_cw_LoadData"));}
  if(appendRow!=null){Data.push(appendRow);sidh("_cw_LoadData",JSON.stringify(Data));}
  document.getElementById("_cw_showLoadTable").innerHTML = SimpleD2T(Data,"tableid");
  let selectElement=gid("_cw_RemoveRow");
  while (selectElement.length > 0) {selectElement.remove(0);}
  for(let i=2;i<Data.length;i++){selectElement.add(new Option(Data[i].join("_"), Data[i].join("_")));}
}

function refreshSFDBMD(){
  sidh("sfd_bmd_solution","");
  sidh("_cw_showSFD2","...");
  sidh("_cw_showBMD2","...");
  //console.log("loaddata = "+gidh("_cw_LoadData"));
  if(gidh("_cw_LoadData")==null || gidh("_cw_LoadData")==""){return "";}
  show_LoadTable();
  show_FBD();
  sfd_bmd_Table();
}
</script>
</head>
<body>
<table  id="headertable" class=BackgroundPattern1 style="width:100%;border-collapse: collapse; border: none;padding:0em;margin:0px;">
  <tr>
  <td style="padding:0px;width:40px;"><span id="cLogo"><img class='rotateimage' src="https://login.ameonlinesolutions.com/images/AMELogo.png" alt='' style=float:left;width:40px;height:40px;border-radius:18px;border:1px solid #fff;display: block;' ></span></td>
  <td style="padding:0px;" align=left nowrap><span id="cName">&nbsp;<font color=white style='font-family: Impact, serif, Charcoal;font-size:30px;'>AME Online Solutions</font></span></td>
  </tr>
  </table>
  
<div id="_cw_MainDiv" align=center>
<div align=center><h1>Shear Force Diagram and Bending Moment Diagram</h1></div>
<table border=1>
<tr><td>
<button id="_cw_addBeam" class="button" >Add Beam</button><br>
<button id="_cw_addSupport" class="button" >Add Support</button><br>
<button id="_cw_addPointLoad" class="button" >Add Point Load</button><br>
<button id="_cw_addMoment" class="button" >Add Moment</button><br>
<button id="_cw_addDistributedLoad" class="button" >Add Distributed load</button>
<br><br><br>
<select name="_cw_RemoveRow" id="_cw_RemoveRow" class="button button3" ><option value=" "> </option></select>
<br><button id="_cw_RemoveIt" class="button button3" >Remove It</button>
</td><td><div align=center id="_cw_LoadFigure" style="width:600px;height:400px;" ></div>
</td></tr><td>
Sample Problems<br>
<button name="SampleProblems" value=1 class="button" >ssb-Point Load</button><br>
<button name="SampleProblems" value=2 class="button" >ssb-Inclined Point Load</button><br>
<button name="SampleProblems" value=3 class="button" >ssb-udl</button><br>
<button name="SampleProblems" value=4 class="button" >ssb-Uniformly Varying Load</button><br>
<button name="SampleProblems" value=5 class="button" >ssb-Combination 1</button><br>
<button name="SampleProblems" value=6 class="button" >ssb-Combination 2</button><br>
<button name="SampleProblems" value=7 class="button" >ssb-Combination 3</button><br>
<button name="SampleProblems" value=8 class="button" >ssb-Combination 4</button><br>
<button name="SampleProblems" value=9 class="button" >ssb-Combination 5</button><br>
<button name="SampleProblems" value=10 class="button" >ssb-Combination 6</button><br>
</td><td>
<div id="_cw_showSFD2" style="width:600px;height:400px;"></div>
</td></tr>
<tr><td></td><td>
<div id="_cw_showBMD2" style="width:600px;height:400px;"></div>
</td></tr>


<tr><td colspan=2>
<div id="_cw_showLoadTable"></div>
</td></tr>
</table>

<!---  Hidden Forms  --->
<div id="_cw_addBeamHidden" hidden align=center>
<br><br><br><br><br><br><table border=1 style="border-collapse:collapse;" ><tr><td>
Beam Length </td><td><input type="number" min=1 max=50 id="_cw_beamLength" value=10 > m</td></tr><tr><td>
<button id="_cw_addBeam_cancel"  >Cancel</button></td><td>
<button id="_cw_addBeam_Add" class="button button1" >Add</button> 
</td></tr></table>
</div>


<div id="_cw_addSupportHidden" hidden align=center>
<br><br><br><br><br><table border=1 style="border-collapse:collapse;" ><tr><td>
<input type="radio" id="pin_support" name="support_choice" checked="checked" value="Hinged Support"> Hinged Support<br>
<img src="https://platform.skyciv.com/storage/images/beam/pin_support_diagram.gif">
</td><td>
<input type="radio" id="roller_support" name="support_choice" value="Roller Support"> Roller Support<br><img src="https://platform.skyciv.com/storage/images/beam/roller_support_diagram.gif">
</td><td>
<input type="radio" id="fixed_support" name="support_choice" value="Fixed Support"> Fixed Support<br><img src="https://platform.skyciv.com/storage/images/beam/fixed_support_diagram.gif">
</td></tr><tr><td colspan=3>
Position <input type="number" id="_cw_SupportPosition" min=0 max=50 value="0" > m <!--<button tabindex="-1" >L</button> <button tabindex="-1" >R</button> -->
</td></tr><td colspan=2>
<button id="_cw_addSupport_cancel"  >Cancel</button></td><td>
<button id="_cw_addSupport_Add" class="button button1" >Add</button>
</td></tr></table>
</div>


<div id="_cw_addPointLoadHidden" hidden align=center>
<br><br><br><br><br><table border=1 style="border-collapse:collapse;" ><tr><td>
Load Location </td><td><input type="text" id="_cw_LoadLocation" value="" > m</td></tr><tr><td>
Load Magnitude</td><td><input type="text" id="_cw_LoadMagnitude" value="" > kN</td></tr><tr><td>
Load Direction </td><td><input type="text" id="_cw_LoadDirection" value="90" > &#176; </td></tr><tr><td>
<button id="_cw_addPointLoad_cancel"  >Cancel</button></td><td>
<button id="_cw_addPointLoad_Add" class="button button1" >Add</button>
</td></tr></table>
</div>


<div id="_cw_addMomentHidden" hidden align=center>
<br><br><br><br><br><table border=1 style="border-collapse:collapse;" ><tr><td>
Moment Location </td><td><input type="text" id="_cw_MomentLocation" value="" > m</td></tr><tr><td>
Moment Magnitude </td><td><input type="text" id="_cw_MomentMagnitude" value="" > kN-m</td></tr><tr><td>
Moment Direction </td><td><select name="_cw_MomentDirection" id="_cw_MomentDirection">
  <option value="C">Clockwise</option>
  <option value="CC">Anticlockwise</option>
</select>
</td></tr><tr><td>
<button id="_cw_addMoment_cancel"  >Cancel</button></td><td>
<button id="_cw_addMoment_Add" class="button button1" >Add</button> 
</td></tr></table>
</div>

<div id="_cw_addDistributedLoadHidden" hidden align=center>
<br><br><br><br><br><table border=1 style="border-collapse:collapse;" ><tr><td>
Start Position </td><td><input type="text" id="_cw_StartPosition" value="" > m</td></tr><tr><td>
End Position </td><td><input type="text" id="_cw_EndPosition" value="" > kN/m</td></tr><tr><td>
Start Magnitude </td><td><input type="text" id="_cw_StartMagnitude" value="" > kN-m</td></tr><tr><td>
End Magnitude </td><td><input type="text" id="_cw_EndMagnitude" value="" > kN/m
</td></tr><tr><td>
<button id="_cw_addMoment_cancel"  >Cancel</button></td><td>
<button id="_cw_addMoment_Add"  class="button button1" >Add</button> </td></tr></table>
</div>


<!---  Hidden Forms Ends --->



<div id="_cw_LoadData" ></div>
<!---<div id="_cw_LoadData" >[["Type","Start/Point Position (m)","End Position (m)","Start/Point Magnitude (kN/m)","End Magnitude (kN/m)","Direction"],["","","","","",""],["Beam",0,"9","","",""],["Hinged Support","0","",-22.22222222222222,"",""],["Roller Support","9","",-17.77777777777778,"",""],["Distributed Load","2","6","10","10",""]]</div> --->
<div id="_cw_MaxX" hidden ></div><div id="_cw_MaxY" hidden ></div><div id="_cw_MinY" hidden ></div><div id="_cw_Landmarks" hidden></div><div id="tempvals"  ></div><div id=sfd_bmd_solution></div><div id="contraflexure" ></div>
<div id="target_id"></div>
<script>
  refreshSFDBMD();
</script>
</div>
<footer><section style="border-top: 1px solid black;margin-top: 10px;padding-top: 5px;font-size: 14px;font-weight: bold;">© <!-- -->2017<!-- -->-<!-- -->2022<!-- --> <!-- -->AME Online Solutions<!-- -->, All rights reserved.</section></footer>
</body>
</html>
